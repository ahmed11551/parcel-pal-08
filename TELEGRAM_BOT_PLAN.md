# –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Telegram Bot + Mini App

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ SendBuddy:
- Telegram Bot –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –ø–æ–¥–ø–∏—Å–æ–∫, –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- Telegram Mini App –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ Telegram
- –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤–µ–± –∏ Telegram

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. Telegram Bot (Node.js + Telegraf)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–¥–∞–Ω–∏—è—Ö
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª/–±–æ—Ç
- –ß–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- FAQ –∏ –ø–æ–º–æ—â—å
- –û—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –º–µ–Ω—é
- `/help` - –ü–æ–º–æ—â—å –∏ FAQ
- `/support` - –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- `/reviews` - –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
- `/subscribe` - –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `/tasks` - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–¥–∞–Ω–∏—è (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App)
- `/profile` - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 2. Telegram Mini App
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ Telegram
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- –ù–∞—Ç–∏–≤–Ω—ã–π UX –≤–Ω—É—Ç—Ä–∏ Telegram

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –£–∂–µ –µ—Å—Ç—å Telegram Web App SDK –≤ `index.html`
- –£–∂–µ –µ—Å—Ç—å `src/lib/telegram.ts` —Å –±–∞–∑–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Telegram

### 3. Backend API –¥–ª—è Telegram
**–ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `POST /api/auth/telegram` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- `POST /api/telegram/subscribe` - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `POST /api/telegram/support` - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
- `POST /api/telegram/review` - –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- `GET /api/telegram/notifications` - –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üõ† –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –≠—Ç–∞–ø 1: –£–ª—É—á—à–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- [ ] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å—é
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤

### –≠—Ç–∞–ø 2: Backend –¥–ª—è Telegram
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/routes/telegram.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é Telegram initData
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### –≠—Ç–∞–ø 3: Telegram Bot
- [ ] –°–æ–∑–¥–∞—Ç—å `telegram-bot/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Telegraf
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

### –≠—Ç–∞–ø 4: Frontend Telegram Integration
- [ ] –£–ª—É—á—à–∏—Ç—å `src/lib/telegram.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Telegram
- [ ] –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å UI –¥–ª—è Telegram Mini App
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è Mini App –∏–∑ –±–æ—Ç–∞

### –≠—Ç–∞–ø 5: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏—è—Ö
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
telegram-bot/
  ‚îú‚îÄ‚îÄ src/
  ‚îÇ   ‚îú‚îÄ‚îÄ index.ts          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
  ‚îÇ   ‚îú‚îÄ‚îÄ commands/         # –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.ts
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ help.ts
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ support.ts
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reviews.ts
  ‚îÇ   ‚îú‚îÄ‚îÄ handlers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ messages.ts
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ callbacks.ts
  ‚îÇ   ‚îî‚îÄ‚îÄ utils/
  ‚îÇ       ‚îú‚îÄ‚îÄ api.ts        # API –∫–ª–∏–µ–Ω—Ç
  ‚îÇ       ‚îî‚îÄ‚îÄ keyboard.ts   # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
  ‚îú‚îÄ‚îÄ package.json
  ‚îî‚îÄ‚îÄ tsconfig.json

backend/src/
  ‚îú‚îÄ‚îÄ routes/
  ‚îÇ   ‚îî‚îÄ‚îÄ telegram.ts       # API –¥–ª—è Telegram
  ‚îî‚îÄ‚îÄ db/
      ‚îî‚îÄ‚îÄ schema.ts         # –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è Telegram

src/
  ‚îú‚îÄ‚îÄ lib/
  ‚îÇ   ‚îî‚îÄ‚îÄ telegram.ts       # –£–ª—É—á—à–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
  ‚îî‚îÄ‚îÄ hooks/
      ‚îî‚îÄ‚îÄ useTelegram.ts    # –•—É–∫ –¥–ª—è Telegram
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è initData:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Telegram
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ (auth_date –Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è hash

2. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
   - JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –°–≤—è–∑—å Telegram ID —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

## üöÄ –î–µ–ø–ª–æ–π

1. **Telegram Bot:**
   - –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
   - Webhook –∏–ª–∏ Long Polling
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞

2. **Mini App:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π frontend
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ @BotFather
   - –£–∫–∞–∑–∞—Ç—å URL –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìù –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_BOT_USERNAME=sendbuddy_bot
TELEGRAM_WEBHOOK_URL=https://send-buddy.ru/api/telegram/webhook

# Telegram Mini App
TELEGRAM_MINI_APP_URL=https://send-buddy.ru
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–£–¥–æ–±—Å—Ç–≤–æ:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ –≤ Telegram
   - –ù–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ë—ã—Å—Ç—Ä–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram

2. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–¥–∞–Ω–∏—è—Ö
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏
   - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

3. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
   - –ß–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä—è–º–æ –≤ Telegram
   - FAQ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
   - –ë—ã—Å—Ç—Ä–∞—è –ø–æ–º–æ—â—å

4. **–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥:**
   - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π
   - –ü—Ä–æ–º–æ-–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
   - –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞

