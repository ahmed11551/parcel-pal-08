# –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –∫–æ–¥–∞ SendBuddy
## –î–∞—Ç–∞: 2025-12-21

---

## üîí 1. –ê–£–î–ò–¢ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### ‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

#### 1.1 SQL Injection Protection
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç prepared statements —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ ($1, $2, etc.)
- **–ü—Ä–∏–º–µ—Ä—ã**:
  ```typescript
  await pool.query('SELECT id FROM users WHERE phone = $1', [phone])
  await pool.query('INSERT INTO users (phone, name) VALUES ($1, $2)', [phone, name])
  ```
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π

#### 1.2 Input Validation
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–∏–º–µ—Ä—ã**:
  ```typescript
  const registerSchema = z.object({
    name: z.string().min(2).max(100),
    phone: z.string().regex(/^\+?[1-9]\d{1,14}$/),
  });
  ```
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π

#### 1.3 JWT Authentication
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - JWT —Ç–æ–∫–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ middleware
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Bearer token –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ JWT_SECRET
- **–§–∞–π–ª**: `backend/src/middleware/auth.ts`
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π

#### 1.4 Rate Limiting
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - Rate limiting –¥–ª—è SMS –∑–∞–ø—Ä–æ—Å–æ–≤ (3 –∑–∞–ø—Ä–æ—Å–∞ / 15 –º–∏–Ω—É—Ç)
  - Rate limiting –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–¥–æ–≤ (5 –ø–æ–ø—ã—Ç–æ–∫ / 15 –º–∏–Ω—É—Ç)
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π

#### 1.5 CORS Configuration
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø
- **–î–µ—Ç–∞–ª–∏**: 
  - CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ FRONTEND_URL –∏–∑ env
  - –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ origin –¥–ª—è Telegram Web App
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É origin –¥–ª—è Telegram Mini App
- **–†–∏—Å–∫**: –°—Ä–µ–¥–Ω–∏–π

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 1.6 XSS Vulnerability –≤ chart.tsx
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï
- **–§–∞–π–ª**: `src/components/ui/chart.tsx:70`
- **–î–µ—Ç–∞–ª–∏**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `dangerouslySetInnerHTML`
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å HTML
- **–†–∏—Å–∫**: –°—Ä–µ–¥–Ω–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö)

#### 1.7 Error Messages
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ –£–õ–£–ß–®–ï–ù–û
- **–î–µ—Ç–∞–ª–∏**: –í production –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ Zod
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –≤ production
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π

#### 1.8 Environment Variables
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò
- **–î–µ—Ç–∞–ª–∏**: 
  - JWT_SECRET –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
  - –ù–æ –¥—Ä—É–≥–∏–µ —Å–µ–∫—Ä–µ—Ç—ã (SMS API keys) –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π

---

## üèóÔ∏è 2. –ê–£–î–ò–¢ BACKEND –ö–û–î–ê

### ‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

#### 2.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ routes, middleware, utils, db
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeScript
  - –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### 2.2 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - Try-catch –±–ª–æ–∫–∏ –≤ async —Ñ—É–Ω–∫—Ü–∏—è—Ö
  - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π error handler middleware
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ logger

#### 2.3 –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π)
- **–ü—Ä–∏–º–µ—Ä**: `backend/src/routes/tasks.ts:173-227`

#### 2.4 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ pino
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
  - –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏ —É–ª—É—á—à–µ–Ω–∏—è

#### 2.5 TypeScript Errors (–ö–†–ò–¢–ò–ß–ù–û)
- **–°—Ç–∞—Ç—É—Å**: ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
- **–§–∞–π–ª—ã**: 
  - `backend/src/routes/auth.ts` - –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è phone –≤–Ω–µ scope
  - `backend/src/utils/sms.ts` - —Ç–∏–ø unknown –¥–ª—è data
- **–°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏**: ‚ùå –ù–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ò–°–ü–†–ê–í–ò–¢–¨ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- **–†–∏—Å–∫**: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

#### 2.6 –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram InitData
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Telegram initData —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- **–§–∞–π–ª**: `backend/src/utils/telegram.ts`

#### 2.7 –û–±—Ä–∞–±–æ—Ç–∫–∞ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –†–ê–ë–û–¢–ê–ï–¢
- **–î–µ—Ç–∞–ª–∏**: 
  - Mock —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç
  - –ù–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è SMS_PROVIDER –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π (–µ—Å—Ç—å fallback –Ω–∞ mock)

#### 2.8 SQL Injection —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï
- **–§–∞–π–ª**: `backend/src/routes/tasks.ts:37-78`
- **–î–µ—Ç–∞–ª–∏**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ SQL –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- **–ê–Ω–∞–ª–∏–∑**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ($1, $2), –Ω–æ –ª–æ–≥–∏–∫–∞ —É—Å–ª–æ–∂–Ω–µ–Ω–∞
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ query builder (kysely, drizzle)
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

---

## üé® 3. –ê–£–î–ò–¢ FRONTEND –ö–û–î–ê

### ‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

#### 3.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - React + TypeScript
  - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
  - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ pages, components, contexts, hooks

#### 3.2 State Management
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: 
  - Context API –¥–ª—è auth
  - React Query –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
  - –õ–æ–∫–∞–ª—å–Ω—ã–π state –¥–ª—è —Ñ–æ—Ä–º

#### 3.3 –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤, email (–≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

#### 3.4 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –•–û–†–û–®–û
- **–î–µ—Ç–∞–ª–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ toast –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏ —É–ª—É—á—à–µ–Ω–∏—è

#### 3.5 Token Storage
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï
- **–î–µ—Ç–∞–ª–∏**: 
  - –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage
  - –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ XSS –∞—Ç–∞–∫–∞–º
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: 
  - –î–ª—è production —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å httpOnly cookies
  - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- **–†–∏—Å–∫**: –°—Ä–µ–¥–Ω–∏–π (XSS –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å —Ç–æ–∫–µ–Ω)

#### 3.6 API Error Handling
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ –£–õ–£–ß–®–ï–ù–û
- **–î–µ—Ç–∞–ª–∏**: 
  - –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - –ù–µ—Ç retry –ª–æ–≥–∏–∫–∏ –¥–ª—è failed requests
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º –∏ —É–ª—É—á—à–∏—Ç—å UX –æ—à–∏–±–æ–∫

#### 3.7 Input Sanitization
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò
- **–î–µ—Ç–∞–ª–∏**: 
  - React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç JSX
  - –ù–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (–æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π) –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –Ω–∞ backend
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è

---

## üß™ 4. –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 4.1 –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ SMS
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –†–ê–ë–û–¢–ê–ï–¢
- **–î–µ—Ç–∞–ª–∏**: 
  - Mock —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç (–∫–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ)
  - –†–µ–∞–ª—å–Ω—ã–µ SMS –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å (—Ç—Ä–µ–±—É–µ—Ç—Å—è –±—É–∫–≤–µ–Ω–Ω—ã–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –≤ SMS.ru)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ Telegram

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
- **–î–µ—Ç–∞–ª–∏**: 
  - `/start` –∫–æ–º–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –°–æ–∑–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Mini App —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

### 4.2 –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –î–û–õ–ñ–ù–û –†–ê–ë–û–¢–ê–¢–¨ (–Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ)
- **–î–µ—Ç–∞–ª–∏**: 
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Zod
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

### 4.3 Telegram Bot
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
- **–î–µ—Ç–∞–ª–∏**: 
  - –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
  - –ö–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
  - Mini App –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

---

## üìã 5. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–¢–†–ï–ë–£–Æ–¢ –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø)

### üî¥ –ö–†–ò–¢–ò–ß–ù–û

1. **TypeScript Compilation Errors**
   - **–§–∞–π–ª—ã**: `backend/src/routes/auth.ts`, `backend/src/utils/sms.ts`
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–¥ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
   - **–°—Ç–∞—Ç—É—Å**: ‚ùå –ë–õ–û–ö–ï–† –î–ï–ü–õ–û–Ø
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 - –ù–ï–ú–ï–î–õ–ï–ù–ù–û

2. **Environment Variables –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: SMS_PROVIDER, TELEGRAM_BOT_TOKEN –Ω–µ –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
   - **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –†–ê–ë–û–¢–ê–ï–¢ –° FALLBACK
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P1 - –í–´–°–û–ö–ò–ô

### üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

3. **Token Storage Security**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –¢–æ–∫–µ–Ω—ã –≤ localStorage —É—è–∑–≤–∏–º—ã –∫ XSS
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P1 - –í–´–°–û–ö–ò–ô

4. **CORS Configuration**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ Telegram Web App origin
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P2 - –°–†–ï–î–ù–ò–ô

5. **Error Messages –≤ Production**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ Zod –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ production
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P2 - –°–†–ï–î–ù–ò–ô

---

## ‚úÖ 6. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏ (–ö–†–ò–¢–ò–ß–ù–û)
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É environment variables
3. ‚ö†Ô∏è –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å httpOnly cookies –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤
4. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Telegram Web App origin –≤ CORS
5. ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –≤ production

### –ö–æ–¥ –∫–∞—á–µ—Å—Ç–≤–æ

1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å query builder –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
4. ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é (–∏–∑–±–µ–≥–∞—Ç—å `any`)

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ Telegram
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
3. ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –Ω–∞ frontend
4. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å loading states –¥–ª—è –≤—Å–µ—Ö async –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üìä 7. –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ‚ö†Ô∏è 7/10
- ‚úÖ SQL injection –∑–∞—â–∏—Ç–∞: –û—Ç–ª–∏—á–Ω–æ
- ‚úÖ Input validation: –•–æ—Ä–æ—à–æ
- ‚ö†Ô∏è Token storage: –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è
- ‚ö†Ô∏è CORS: –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Telegram

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞: ‚ö†Ô∏è 6/10
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –•–æ—Ä–æ—à–æ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –•–æ—Ä–æ—à–æ
- ‚ùå TypeScript errors: –ö–†–ò–¢–ò–ß–ù–û
- ‚ö†Ô∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production: ‚ùå –ù–ï–¢
- **–ë–ª–æ–∫–µ—Ä—ã**: TypeScript compilation errors
- **–ö—Ä–∏—Ç–∏—á–Ω–æ**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å environment variables
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üéØ 8. –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–¥–æ –¥–µ–ø–ª–æ—è):
1. ‚ùå –ò—Å–ø—Ä–∞–≤–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏ –≤ auth.ts –∏ sms.ts
2. ‚ùå –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É environment variables –≤ docker-compose.yml
3. ‚ö†Ô∏è –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (1-2 –Ω–µ–¥–µ–ª–∏):
1. –£–ª—É—á—à–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –¥–ª—è Telegram
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
4. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ (1 –º–µ—Å—è—Ü):
1. –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–ª–æ–∂–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥

---

**–ê—É–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω**: 2025-12-21
**–°–ª–µ–¥—É—é—â–∏–π –∞—É–¥–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω**: –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

