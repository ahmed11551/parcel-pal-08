# Настройка SMS для SendBuddy

## Проблема
В development режиме SMS не отправляются реально, только логируются в консоль. Для production нужно настроить реальный SMS провайдер.

## Решение

### Вариант 1: SMS.ru (Рекомендуется для России)

1. Зарегистрируйтесь на [sms.ru](https://sms.ru)
2. Перейдите в раздел "Интеграция" (или используйте прямую ссылку: https://sms.ru/integrate)
3. **Выберите "Node.JS"** (хотя можно использовать любую технологию, так как мы используем простые HTTP запросы)
4. Получите API ID в личном кабинете:
   - Войдите в личный кабинет
   - Перейдите в раздел "API" или "Настройки"
   - Скопируйте ваш API ID
5. Добавьте в `.env.production`:
   ```env
   SMS_PROVIDER=smsru
   SMSRU_API_ID=your_api_id_here
   ```

**Примечание:** В нашем коде уже реализована интеграция через HTTP запросы, поэтому вам не нужно устанавливать дополнительные пакеты. Просто получите API ID и добавьте его в переменные окружения.

### Вариант 2: Twilio

1. Зарегистрируйтесь на [twilio.com](https://www.twilio.com)
2. Получите:
   - Account SID
   - Auth Token
   - Phone Number
3. Установите пакет:
   ```bash
   cd backend
   npm install twilio
   ```
4. Добавьте в `.env.production`:
   ```env
   SMS_PROVIDER=twilio
   TWILIO_ACCOUNT_SID=your_account_sid
   TWILIO_AUTH_TOKEN=your_auth_token
   TWILIO_PHONE_NUMBER=+1234567890
   ```

### Вариант 3: Другой провайдер

Добавьте поддержку в `backend/src/utils/sms.ts` по аналогии с существующими провайдерами.

## Development режим

В development режиме (или когда `SMS_PROVIDER=mock`):
- SMS не отправляются реально
- Код показывается в консоли backend
- Код также возвращается в API ответе и показывается на frontend (только в dev режиме!)

## Проверка работы

1. В development: код будет показан в интерфейсе
2. В production: код придет на телефон через SMS

## Документация API

Полная документация SMS.ru API доступна по адресу: [https://sms.ru/api](https://sms.ru/api)

### Основные методы API:
- **Отправка SMS**: `POST https://sms.ru/sms/send`
- **Проверка статуса**: `GET https://sms.ru/sms/status`
- **Проверка баланса**: `GET https://sms.ru/my/balance`
- **Проверка стоимости**: `GET https://sms.ru/sms/cost`

### Формат ответа:
```json
{
  "status": "OK",
  "status_code": 100,
  "sms": {
    "79991234567": {
      "status": "OK",
      "status_code": 100,
      "sms_id": "000000-10000000"
    }
  },
  "balance": 9.5
}
```

**Коды статусов:**
- `100` - Сообщение принято к отправке
- `200` - Неправильный api_id
- `201` - Не хватает средств на счете
- `202` - Неправильно указан получатель
- И другие (см. [документацию](https://sms.ru/api))

## Важно

⚠️ **Никогда не используйте mock режим в production!**
- Убедитесь что `SMS_PROVIDER` настроен правильно
- Проверьте что переменные окружения установлены
- **Пополните баланс** на SMS.ru перед использованием
- Протестируйте отправку SMS перед запуском в production
- Проверьте баланс: в ответе API возвращается текущий баланс

### Пополнение баланса:
1. Войдите в личный кабинет SMS.ru
2. Перейдите в раздел "Пополнение счета"
3. Выберите способ оплаты и пополните баланс
4. Минимальная сумма пополнения обычно 100-300 рублей

